[phases.setup]
# Install Node 20 + Python 3 from nixpkgs
nixPkgs = ["nodejs_20", "python312", "python312Packages.pip"]

[phases.install]
cmds = [
  "pip install yt-dlp",
  "npm ci"
]

[phases.build]
cmds = ["NEXT_STANDALONE=1 npm run build"]

[start]
# Copy static assets next to server.js, then start (standalone doesn't bundle them)
cmd = "cp -r .next/static .next/standalone/.next/static && node .next/standalone/server.js"
